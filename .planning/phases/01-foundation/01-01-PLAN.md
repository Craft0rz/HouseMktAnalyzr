---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Set up Python project structure with property data models and configuration system.

Purpose: Establish the foundation that all other phases depend on - consistent data structures for properties and investment metrics, plus configurable settings for API keys and analysis parameters.
Output: Installable Python package with Pydantic models and environment-based configuration.
</objective>

<execution_context>
@~/.claude/skills/create-plans/workflows/execute-phase.md
@~/.claude/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Python project structure</name>
  <files>pyproject.toml, src/housemktanalyzr/__init__.py, src/housemktanalyzr/py.typed, requirements.txt</files>
  <action>
    Create modern Python project with pyproject.toml using setuptools backend.

    Dependencies to include:
    - pydantic>=2.0 (data models with validation)
    - pydantic-settings (environment configuration)
    - httpx (async HTTP client for API calls)
    - rich (CLI output formatting)
    - python-dotenv (env file loading)

    Dev dependencies:
    - pytest
    - ruff (linting)

    Use src/ layout for proper package isolation.
    Include py.typed marker for type checking support.
    Create requirements.txt for pip users (export from pyproject.toml deps).
  </action>
  <verify>pip install -e . succeeds, python -c "import housemktanalyzr" works</verify>
  <done>Package installs without errors, can be imported</done>
</task>

<task type="auto">
  <name>Task 2: Create Property data models</name>
  <files>src/housemktanalyzr/models/__init__.py, src/housemktanalyzr/models/property.py</files>
  <action>
    Create Pydantic models for real estate listings:

    PropertyType enum: HOUSE, DUPLEX, TRIPLEX, QUADPLEX, MULTIPLEX (5+ units)

    PropertyListing model:
    - id: str (unique identifier from source)
    - source: str (centris, realtor, etc.)
    - address: str
    - city: str
    - postal_code: str | None
    - price: int (asking price in CAD)
    - property_type: PropertyType
    - bedrooms: int
    - bathrooms: float (allow half baths)
    - sqft: int | None (living area)
    - lot_sqft: int | None
    - year_built: int | None
    - units: int (1 for house, 2 for duplex, etc.)
    - estimated_rent: int | None (monthly, per unit or total)
    - listing_date: date | None
    - url: str
    - raw_data: dict | None (store original API response)

    InvestmentMetrics model:
    - property_id: str
    - purchase_price: int
    - estimated_monthly_rent: int
    - gross_rental_yield: float (annual rent / price * 100)
    - cap_rate: float | None (NOI / price * 100)
    - price_per_unit: int (for multi-door)
    - price_per_sqft: float | None
    - cash_flow_monthly: float | None (after expenses estimate)
    - score: float (0-100 investment score)
    - score_breakdown: dict (component scores)

    Use Pydantic validators for computed fields where appropriate.
  </action>
  <verify>python -c "from housemktanalyzr.models import PropertyListing, InvestmentMetrics; print('Models OK')"</verify>
  <done>Models import correctly, validation works on sample data</done>
</task>

<task type="auto">
  <name>Task 3: Create configuration system</name>
  <files>src/housemktanalyzr/config.py, .env.example</files>
  <action>
    Create settings class using pydantic-settings:

    Settings class with:
    - region: str = "montreal" (target market)
    - min_price: int = 200000
    - max_price: int = 2000000
    - property_types: list[str] = ["DUPLEX", "TRIPLEX", "QUADPLEX", "MULTIPLEX"]
    - min_units: int = 2 (focus on income properties)
    - target_yield: float = 5.0 (minimum gross yield %)
    - target_cap_rate: float = 4.0 (minimum cap rate %)

    API keys (loaded from env):
    - centris_api_key: str | None = None
    - realtor_api_key: str | None = None

    Data paths:
    - data_dir: Path = Path("data")
    - cache_dir: Path = Path(".cache")

    Use model_config to load from .env file.
    Create .env.example with all variables documented.
    Create singleton pattern: `config = Settings()` for easy import.
  </action>
  <verify>python -c "from housemktanalyzr.config import config; print(f'Region: {config.region}')"</verify>
  <done>Config loads from environment, defaults work, .env.example documents all options</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `pip install -e .` succeeds
- [ ] `python -c "from housemktanalyzr.models import PropertyListing, InvestmentMetrics"` works
- [ ] `python -c "from housemktanalyzr.config import config"` works
- [ ] All Pydantic models validate sample data correctly
- [ ] .env.example documents all configuration options
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Package structure follows Python best practices
- Models have proper type hints and validation
- Configuration loads from environment with sensible defaults
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`:

# Phase 1 Plan 1: Foundation Summary

**[Substantive one-liner describing what was built]**

## Accomplishments
- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified
- `path/to/file` - Description

## Decisions Made
[Key decisions and rationale, or "None"]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
[Ready for Phase 2 or next plan]
</output>
