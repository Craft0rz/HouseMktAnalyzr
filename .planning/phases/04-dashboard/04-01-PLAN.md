---
phase: 04-dashboard
plan: 01
type: execute
---

<objective>
Create a Streamlit dashboard for viewing and analyzing property listings.

Purpose: Provide an interactive interface to browse properties, view investment metrics, and identify top opportunities. Replace terminal output with a visual dashboard.
Output: Working Streamlit app with property table, filters, and detail views.
</objective>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@src/housemktanalyzr/analysis/ranker.py
@src/housemktanalyzr/models/property.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Streamlit dependency and create app structure</name>
  <files>pyproject.toml, src/housemktanalyzr/dashboard/__init__.py, src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Add streamlit to dependencies and create dashboard module:

    ```python
    # dashboard/app.py
    import streamlit as st
    from housemktanalyzr.analysis import PropertyRanker
    from housemktanalyzr.collectors.centris import CentrisScraper

    st.set_page_config(
        page_title="HouseMktAnalyzr",
        page_icon="üè†",
        layout="wide",
    )

    def main():
        st.title("üè† HouseMktAnalyzr")
        st.subheader("Greater Montreal Investment Property Analyzer")
        # Sidebar for filters
        # Main area for property table
    ```
  </action>
  <verify>python -c "from housemktanalyzr.dashboard.app import main; print('Dashboard module OK')"</verify>
  <done>Dashboard module created with Streamlit setup</done>
</task>

<task type="auto">
  <name>Task 2: Create property listing table with metrics</name>
  <files>src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Add interactive property table with:

    - Sortable columns (score, price, cap rate, cash flow)
    - Color-coded scores (green=good, yellow=ok, red=poor)
    - Clickable rows to show detail view
    - Pagination for large result sets

    Use st.dataframe or st.data_editor for the table.
    Include columns: Address, City, Type, Price, Units, Score, Cap Rate, Cash Flow
  </action>
  <verify>streamlit run src/housemktanalyzr/dashboard/app.py --server.headless true &amp;&amp; sleep 3 &amp;&amp; curl -s http://localhost:8501 | head -20</verify>
  <done>Property table displays with investment metrics</done>
</task>

<task type="auto">
  <name>Task 3: Add sidebar filters and search controls</name>
  <files>src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Create sidebar with filter controls:

    ```python
    with st.sidebar:
        st.header("Filters")

        # Region selector
        region = st.selectbox("Region", ["montreal-south-shore", "montreal-island", ...])

        # Property type multi-select
        property_types = st.multiselect("Property Types", [...])

        # Price range slider
        price_range = st.slider("Price Range", 200000, 2000000, (300000, 800000))

        # Minimum score
        min_score = st.slider("Minimum Score", 0, 100, 50)

        # Fetch button
        if st.button("Search Properties"):
            # Fetch and analyze
    ```
  </action>
  <verify>Check that sidebar renders with all filter controls</verify>
  <done>Sidebar filters allow narrowing property search</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Streamlit app launches without errors
- [ ] Property table displays with all key metrics
- [ ] Sidebar filters work (region, type, price, score)
- [ ] Properties can be fetched from Centris via UI
- [ ] Scores are color-coded for quick visual assessment
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Dashboard is usable for browsing 200+ properties
- Ready for 04-02 (comparison feature)
</success_criteria>

<output>
After completion, create `.planning/phases/04-dashboard/04-01-SUMMARY.md`
</output>
