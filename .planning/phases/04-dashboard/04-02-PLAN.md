---
phase: 04-dashboard
plan: 02
type: execute
---

<objective>
Add side-by-side property comparison feature to the dashboard.

Purpose: Enable investors to compare 2-4 properties directly, seeing all metrics and differences highlighted. Core success criteria from BRIEF.md.
Output: Comparison view with property cards and metric highlighting.
</objective>

<context>
@.planning/BRIEF.md
@.planning/phases/04-dashboard/04-01-SUMMARY.md
@src/housemktanalyzr/dashboard/app.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add property selection for comparison</name>
  <files>src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Add checkboxes or selection mechanism to choose properties for comparison:

    - Allow selecting 2-4 properties from the table
    - Show "Compare Selected" button when 2+ selected
    - Track selected properties in session state
    - Clear selection option
  </action>
  <verify>Select multiple properties and verify selection state persists</verify>
  <done>Property selection for comparison works</done>
</task>

<task type="auto">
  <name>Task 2: Create comparison view layout</name>
  <files>src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Create side-by-side comparison display:

    ```python
    def show_comparison(properties: list[tuple[PropertyListing, InvestmentMetrics]]):
        cols = st.columns(len(properties))

        for col, (listing, metrics) in zip(cols, properties):
            with col:
                st.subheader(listing.address[:30])
                st.metric("Price", f"${listing.price:,}")
                st.metric("Score", f"{metrics.score}/100")
                st.metric("Cap Rate", f"{metrics.cap_rate:.1f}%")
                st.metric("Cash Flow", f"${metrics.cash_flow_monthly:,.0f}/mo")
                # More metrics...
    ```

    Display key metrics:
    - Price, Price/Unit, Price/sqft
    - Score with breakdown
    - Cap Rate, Yield, GRM
    - Monthly Cash Flow
    - Property details (units, beds, baths)
  </action>
  <verify>Comparison view shows properties side-by-side with all metrics</verify>
  <done>Comparison layout displays selected properties</done>
</task>

<task type="auto">
  <name>Task 3: Add metric highlighting and winner indicators</name>
  <files>src/housemktanalyzr/dashboard/app.py</files>
  <action>
    Highlight best values in comparison:

    - Green highlight for best score/cap rate/cash flow
    - Red highlight for worst values
    - Delta indicators showing difference from best
    - Overall "winner" badge based on score

    Use st.metric with delta parameter for comparisons.
  </action>
  <verify>Best values are highlighted, deltas shown correctly</verify>
  <done>Comparison highlights best investment metrics</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Can select 2-4 properties for comparison
- [ ] Comparison view shows side-by-side cards
- [ ] All key metrics displayed for each property
- [ ] Best values highlighted (green)
- [ ] Deltas/differences shown between properties
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Comparison is intuitive and highlights key differences
- Phase 4 complete - ready for Phase 5 (Alerts)
</success_criteria>

<output>
After completion, create `.planning/phases/04-dashboard/04-02-SUMMARY.md`
</output>
