# TO-DOS

## Compare Tab — Add New Market Data - 2026-02-07 21:30

- **Add comparable market data to Compare tab** - Incorporate all newly added data sources (rent trends, demographics, safety, market rates) into the property comparison view. **Problem:** Compare tab currently only shows basic financial metrics; the 4 phases of market intelligence data aren't surfaced there, making side-by-side comparison incomplete. **Files:** `frontend/src/app/compare/page.tsx`, `frontend/src/lib/types.ts`, `backend/app/routers/analysis.py`.

## Favorites / Watch List - 2026-02-07 21:31

- **Add favorites/watch list feature** - Allow users to save properties to a persistent watch list for monitoring. **Problem:** No way to bookmark or track interesting properties across sessions; users lose track of properties they want to revisit. **Files:** `frontend/src/app/portfolio/page.tsx` (or new route), `backend/app/routers/` (new endpoint), `backend/app/db.py` (new table). **Solution:** Local storage for MVP, then DB-backed if user accounts are added later.

## Update UI Score Breakdown - 2026-02-07 21:45

- **Update PropertyDetail score display for two-pillar breakdown** - Show the Financial (0-70) and Location & Quality (0-30) pillars separately in the UI instead of just a single total score. **Problem:** The backend now returns a two-pillar score (Financial 70 + Location 30 = 100) with detailed breakdown keys (cap_rate, cash_flow, price_per_unit for financial; safety, vacancy, rent_growth, affordability, condition for location), but the frontend only displays a single aggregate score number. Users can't see what's driving their score. **Files:** `frontend/src/components/PropertyDetail.tsx`, `frontend/src/components/PropertyTable.tsx`, `frontend/src/lib/types.ts` (InvestmentMetrics.score_breakdown), `src/housemktanalyzr/analysis/calculator.py:calculate_location_score`. **Solution:** Add a score breakdown card/section in PropertyDetail showing each pillar with its sub-components as progress bars or a radar chart. Update PropertyTable tooltip to preview the breakdown.

## Login System / User Tracking - 2026-02-07 23:15

- **Build user authentication system** - Add login/signup so usage can be tracked per user. **Problem:** No way to identify who is using the tool; needed for usage analytics, personalized features (saved searches, watch lists), and potential access control. **Files:** `backend/app/main.py` (add auth middleware), `backend/app/routers/` (new `auth.py` router), `backend/app/db.py` (new `users` table), `frontend/src/lib/providers.tsx` (auth context), `frontend/src/components/Header.tsx` (login/logout UI). **Solution:** Start with email+password or OAuth (Google) via FastAPI + JWT tokens; store sessions server-side; add auth context in frontend; protect API routes with dependency injection. Consider NextAuth.js for frontend or a simple custom JWT flow.

## Scraper Price Updates & Sold Properties - 2026-02-08 06:23

- **Investigate and improve listing lifecycle tracking** - Determine how the scraper handles price changes and sold/delisted properties. **Problem:** Currently, price changes are tracked via UPSERT + `price_history` table and alerts fire on drops — this works. However, sold/delisted properties are NOT explicitly marked; they simply expire after a 6-hour TTL (`CACHE_TTL_HOURS`). There's no `status='sold'` field, no "days on market" tracking, and no way to distinguish "sold" from "delisted" from "expired cache." Users can't see price history or know if a property was recently sold. **Files:** `backend/app/db.py:256-298` (cache_listings UPSERT + price_history), `backend/app/db.py:320,375` (expires_at filtering), `backend/app/scraper_worker.py:27` (CACHE_TTL_HOURS=6), `backend/app/alert_checker.py:245-284` (_find_price_drops). **Solution:** Consider adding: (1) a `status` field to properties table (active/sold/delisted), (2) a comparison between scrape cycles to detect disappearances, (3) price history display in the frontend, (4) "days on market" metric from first_seen to last_seen timestamps.

## Price Change Display in Frontend - 2026-02-08 06:32

- **Surface price history and price change indicators in the UI** - Show users when a listing's price has changed, with full history timeline. **Problem:** The `price_history` table already records every price change detected between scrape cycles (old_price, new_price, recorded_at), but this data is never exposed to users. There's no API endpoint to fetch it, no "Price Dropped" badge on the PropertyTable, and no price timeline in PropertyDetail. Users have no way to see if a property was recently reduced. **Files:** `backend/app/db.py:107-119` (price_history table schema), `backend/app/db.py:269-282` (price change recording in cache_listings), `backend/app/routers/properties.py` (add GET endpoint), `frontend/src/lib/api.ts` (add client call), `frontend/src/lib/types.ts` (add PriceChange type), `frontend/src/components/PropertyDetail.tsx` (add price timeline), `frontend/src/components/PropertyTable.tsx` (add price drop badge). **Solution:** (1) Add `GET /api/properties/{id}/price-history` endpoint returning list of {old_price, new_price, recorded_at}, (2) Add "Price Reduced" badge with amount on PropertyTable rows where recent price drop detected, (3) Add price timeline section in PropertyDetail showing all changes as a stepped chart or list.

## French Language Toggle (i18n) - 2026-02-08 06:37

- **Add bilingual English/French support with language toggle** - Allow users to switch the entire UI between English and French. **Problem:** The app targets the Montreal/Quebec market where many users are francophone, but the UI is English-only. No internationalization infrastructure exists — all strings are hardcoded in components. **Files:** `frontend/src/components/Header.tsx` (add language toggle button), `frontend/src/lib/providers.tsx` (add i18n context/provider), `frontend/src/components/PropertyDetail.tsx` (translate labels), `frontend/src/components/PropertyTable.tsx` (translate column headers), `frontend/src/app/layout.tsx` (wrap with i18n provider), `frontend/src/app/dashboard/page.tsx` (translate dashboard text). **Solution:** Use `next-intl` or a lightweight i18n approach: (1) Create `messages/en.json` and `messages/fr.json` with all UI strings, (2) Add a language context provider with localStorage persistence, (3) Add FR/EN toggle button in Header next to theme toggle, (4) Replace hardcoded strings with translation keys across all components. Start with major pages (dashboard, property detail, table headers) then expand coverage.

